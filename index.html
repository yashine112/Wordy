<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wordy</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700;800&family=Nunito:wght@700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --ink:#0F172A;
      --muted:#64748B;
      --stroke: rgba(15,23,42,.10);
      --glass: rgba(255,255,255,.80);
      --shadow: 0 18px 50px rgba(15,23,42,.14);
      --shadow2: 0 10px 24px rgba(15,23,42,.10);
      --ring: 0 0 0 4px rgba(124,58,237,.18);

      --p1:#8B5CF6; /* purple */
      --p2:#EC4899; /* pink */
      --c1:#06B6D4; /* cyan */
      --m1:#22C55E; /* mint */
      --g1:#16A34A; /* green */
      --r1:#EF4444; /* red */
      --d1:#111827; /* dark */
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:"Nunito", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1100px 700px at 15% 10%, #FFE3F1 0%, transparent 55%),
        radial-gradient(950px 700px at 85% 25%, #D8F5FF 0%, transparent 58%),
        radial-gradient(900px 700px at 55% 95%, #E8FFE7 0%, transparent 55%),
        linear-gradient(180deg, #FFF7FB, #F2FBFF);
      min-height:100vh;
      overflow-x:hidden;
      position:relative;
    }
    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(236,72,153,.20) 0 3px, transparent 4px),
        radial-gradient(circle at 80% 15%, rgba(139,92,246,.18) 0 3px, transparent 4px),
        radial-gradient(circle at 60% 80%, rgba(34,197,94,.18) 0 3px, transparent 4px),
        radial-gradient(circle at 20% 75%, rgba(6,182,212,.18) 0 3px, transparent 4px),
        radial-gradient(circle at 35% 45%, rgba(245,158,11,.16) 0 3px, transparent 4px),
        radial-gradient(circle at 92% 55%, rgba(99,102,241,.16) 0 3px, transparent 4px);
      background-repeat:no-repeat;
      opacity:.9;
    }

    .wrap{ max-width:640px; margin:0 auto; padding:20px 16px 34px; }

    .brand{ text-align:center; margin:6px 0 12px; }
    .brand h1{
      margin:0;
      font-family:"Baloo 2","Nunito",system-ui,sans-serif;
      font-size:56px;
      line-height:1.0;
      font-weight:800;
      background: linear-gradient(135deg, var(--p1), var(--p2), var(--c1));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      text-shadow: 0 10px 26px rgba(124,58,237,.12);
    }
    .brand p{ margin:10px 0 0; font-size:14px; color:var(--muted); font-weight:900; }

    .card{
      background: var(--glass);
      border: 2px solid rgba(255,255,255,.85);
      box-shadow: var(--shadow);
      border-radius: 30px;
      padding: 16px;
      backdrop-filter: blur(14px);
      position:relative;
      overflow:hidden;
    }
    .card::before, .card::after{
      content:"";
      position:absolute;
      width:180px; height:180px;
      border-radius: 36px;
      opacity:.25;
      pointer-events:none;
    }
    .card::before{
      right:-70px; top:-70px;
      background: radial-gradient(circle at 30% 30%, rgba(236,72,153,.65), rgba(139,92,246,.35), transparent 60%);
      transform: rotate(10deg);
    }
    .card::after{
      left:-80px; bottom:-80px;
      background: radial-gradient(circle at 40% 40%, rgba(34,197,94,.60), rgba(6,182,212,.35), transparent 60%);
      transform: rotate(-12deg);
    }

    .panel{
      background: rgba(255,255,255,.82);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow2);
      border-radius: 22px;
      padding: 14px;
    }

    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin:2px 0 8px;
      text-align:left;
      font-weight:1000;
      letter-spacing:.3px;
      text-transform: uppercase;
    }

    input, select, button{
      width:100%;
      font-size:16px;
      border-radius:18px;
      padding:14px 14px;
      font-family:"Nunito",system-ui,sans-serif;
    }

    input, select{
      background:#fff;
      color:var(--ink);
      border:2px solid rgba(15,23,42,.08);
      outline:none;
      box-shadow: 0 8px 18px rgba(15,23,42,.06);
    }
    input:focus, select:focus{ box-shadow: var(--ring); border-color: rgba(124,58,237,.35); }

    .grid2{ display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px; }

    button{
      border:none;
      cursor:pointer;
      font-weight:1000;
      letter-spacing:.2px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 14px 22px rgba(15,23,42,.14);
      transition: transform .08s ease, filter .15s ease;
      position:relative;
      overflow:hidden;
    }
    button:active{ transform: translateY(1px); }
    button:disabled{ opacity:.55; cursor:not-allowed; filter:saturate(.6); }

    button::after{
      content:"";
      position:absolute;
      inset:-40% -20% auto -20%;
      height:120%;
      background: linear-gradient(120deg, rgba(255,255,255,.0), rgba(255,255,255,.35), rgba(255,255,255,.0));
      transform: rotate(10deg);
      opacity:.6;
      pointer-events:none;
    }

    .btnPrimary{ background: linear-gradient(135deg, var(--p1), var(--p2)); color:white; }
    .btnDark{ background: linear-gradient(135deg, #111827, #334155); color:white; }
    .btnGood{ background: linear-gradient(135deg, #16A34A, #22C55E); color:white; }
    .btnBad{ background: linear-gradient(135deg, #EF4444, #F97316); color:white; }
    .btnWord{ background: linear-gradient(135deg, #06B6D4, #22C55E); color:white; }

    /* SUPER SICHTBAR: Wer ist dran */
    .turnBig{
      margin-top:14px;
      border-radius: 26px;
      padding: 14px;
      background: rgba(255,255,255,.94);
      border: 4px solid rgba(124,58,237,.22);
      box-shadow: 0 18px 30px rgba(15,23,42,.12);
      text-align:center;
    }
    .turnBig .small{
      font-size:12px;
      color:var(--muted);
      font-weight:1000;
      text-transform:uppercase;
      letter-spacing:.25px;
      margin-bottom:6px;
    }
    .turnBig .name{
      font-family:"Baloo 2","Nunito",system-ui,sans-serif;
      font-size:40px;
      font-weight:800;
      line-height:1.05;
    }
    .turnBig .badge{
      display:inline-block;
      margin-top:10px;
      padding:8px 14px;
      border-radius:999px;
      font-size:13px;
      font-weight:1000;
      background: rgba(124,58,237,.12);
      border:2px solid rgba(124,58,237,.22);
      color:#5B21B6;
    }

    .wordCard{
      margin-top:14px;
      border-radius:28px;
      padding:18px 16px;
      background: rgba(255,255,255,.96);
      border: 2px dashed rgba(124,58,237,.28);
      box-shadow: 0 18px 34px rgba(15,23,42,.12);
      text-align:center;
      min-height: 160px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:10px;
    }
    .wordHint{ font-size:13px; color:var(--muted); font-weight:1000; }
    .word{
      font-family:"Baloo 2","Nunito",system-ui,sans-serif;
      font-size:48px;
      font-weight:800;
      letter-spacing:-.4px;
      line-height:1.05;
      padding:4px 6px;
      will-change: transform, opacity;
    }
    .pop{ animation: popIn .22s ease-out; }
    @keyframes popIn{ from{ transform: scale(.97); opacity:.65;} to{ transform: scale(1); opacity:1;} }

    .scoreRow{ margin-top:12px; display:grid; grid-template-columns:1fr; gap:10px; }
    .scoreBox{
      border-radius:22px;
      padding:12px 14px;
      background: rgba(255,255,255,.88);
      border: 1px solid var(--stroke);
      box-shadow: 0 12px 20px rgba(15,23,42,.08);
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      font-weight:1000;
    }
    .muted{ color:var(--muted); font-weight:1000; }

    /* Ãœbergabe-Screen */
    .overlay{
      position:fixed;
      inset:0;
      background: rgba(15,23,42,.45);
      backdrop-filter: blur(8px);
      z-index: 20000;
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }
    .overlay.show{ display:flex; }
    .overlayCard{
      width:min(520px, 100%);
      background: rgba(255,255,255,.95);
      border: 2px solid rgba(255,255,255,.9);
      border-radius: 28px;
      box-shadow: 0 24px 70px rgba(15,23,42,.30);
      padding: 18px;
      text-align:center;
    }
    .overlayCard .emoji{ font-size:36px; margin-bottom:6px; }
    .overlayCard .title{
      font-family:"Baloo 2","Nunito",system-ui,sans-serif;
      font-size:34px;
      font-weight:800;
      margin: 2px 0 6px;
    }
    .overlayCard .text{
      color:var(--muted);
      font-weight:900;
      margin: 0 0 14px;
    }

    .hidden{ display:none !important; }
  </style>
</head>

<body>
  <div class="overlay" id="handoff">
    <div class="overlayCard">
      <div class="emoji">ðŸ“±âœ¨</div>
      <div class="title" id="handoffTitle">Handy weitergeben</div>
      <p class="text" id="handoffText">Gib das Handy an â€¦</p>
      <button class="btnPrimary" id="handoffOk" type="button">Okay!</button>
    </div>
  </div>

  <div class="wrap">
    <div class="brand">
      <h1>Wordy</h1>
      <p>Start â†’ Handy weitergeben â†’ Wort anzeigen â†’ bewerten</p>
    </div>

    <div class="card">
      <div class="panel">
        <label for="p1name">Name Spieler 1</label>
        <input id="p1name" type="text" placeholder="z. B. Mia" maxlength="18" />

        <label for="p2name" style="margin-top:12px;">Name Spieler 2 (optional)</label>
        <input id="p2name" type="text" placeholder="leer = 1 Spieler" maxlength="18" />

        <label for="difficulty" style="margin-top:12px;">Schwierigkeitsgrad</label>
        <select id="difficulty">
          <option value="leicht" selected>Leicht</option>
          <option value="mittel">Mittel</option>
          <option value="schwer">Schwer</option>
        </select>

        <label for="type" style="margin-top:12px;">Wortart</label>
        <select id="type">
          <option value="all" selected>Alles</option>
          <option value="nomen">Nomen</option>
          <option value="verb">Verb</option>
          <option value="adj">Adjektiv</option>
        </select>

        <div class="grid2">
          <button id="startBtn" class="btnPrimary" type="button">Start</button>
          <button id="restartBtn" class="btnDark" type="button">Neues Spiel</button>
        </div>
      </div>

      <div id="turnBox" class="turnBig hidden">
        <div class="small">Jetzt dran</div>
        <div class="name" id="turnName">Spieler 1</div>
        <div class="badge" id="turnBadge">Spieler 1</div>
      </div>

      <div class="wordCard">
        <div class="wordHint" id="wordHint">DrÃ¼ck Start ðŸ˜Š</div>
        <div class="word pop" id="word">â€”</div>
        <button id="revealBtn" class="btnWord" type="button" disabled>Wort anzeigen</button>
      </div>

      <div class="scoreRow">
        <div class="scoreBox">
          <span id="scoreText">Punkte: 0</span>
          <span class="muted" id="titleText">Titel: AnfÃ¤nger</span>
        </div>

        <div id="score2Box" class="scoreBox hidden">
          <span id="scoreText2">Punkte: 0</span>
          <span class="muted" id="titleText2">Titel: AnfÃ¤nger</span>
        </div>
      </div>

      <div class="grid2" style="margin-top:12px;">
        <button id="rightBtn" class="btnGood" type="button" disabled>Richtig (+1)</button>
        <button id="wrongBtn" class="btnBad" type="button" disabled>Falsch (âˆ’1)</button>
      </div>
    </div>
  </div>

  <script>
    const TITLES = ["AnfÃ¤nger","Autor","ErzÃ¤hler","Wortmeister","Sprachheld","Legende","Mythos","Sternenschreiber"];

    const WORDS = {
      leicht: {
        nomen: ["Apfel","Hund","Katze","Schule","Buch","Ball","Auto","Blume","Baum","Brot","KÃ¤se","Milch","Sonne","Regen","Wasser","Eis","Tisch","Stuhl","Bett","Haus"],
        verb:  ["laufen","springen","lesen","malen","lachen","schlafen","essen","trinken","spielen","singen","tanzen","kaufen","helfen","finden","werfen","sehen","hÃ¶ren","rufen","sitzen","stehen"],
        adj:   ["bunt","schnell","langsam","groÃŸ","klein","nett","laut","leise","warm","kalt","rund","weich","hart","sauber","schmutzig","lustig","traurig","stark","schwach","frÃ¶hlich"]
      },
      mittel: {
        nomen: ["Abenteuer","Geheimnis","Regenbogen","Bibliothek","Schatzkarte","Kompass","Rakete","Astronaut","Roboter","Dschungel","Vulkan","Wasserfall","Labyrinth","Pyramide","Mikroskop","Experiment","Orchester","Publikum","TrophÃ¤e","Teamgeist"],
        verb:  ["entdecken","verstecken","vergleichen","erklÃ¤ren","beobachten","erfinden","trainieren","Ã¼berzeugen","organisieren","reparieren","untersuchen","kombinieren","vermeiden","beschreiben","planen","Ã¼berraschen","verbessern","entscheiden","verÃ¤ndern","kontern"],
        adj:   ["neugierig","geheim","riesig","knifflig","tapfer","geduldig","plÃ¶tzlich","vorsichtig","aufmerksam","vertrÃ¤umt","mysteriÃ¶s","elegant","praktisch","hilfsbereit","ehrlich","mutig","stolz","witzig","ruhig","wild"]
      },
      schwer: {
        nomen: ["Gerechtigkeit","Verantwortung","Interpretation","Perspektive","Widerspruch","Zusammenhang","Entscheidung","VerÃ¤nderung","Nachhaltigkeit","Bewusstsein","Selbstvertrauen","Zivilcourage","Datenschutz","Filterblase","Klimawandel","BiodiversitÃ¤t","Argumentation","Diplomatie","KomplexitÃ¤t","Konsequenz"],
        verb:  ["reflektieren","argumentieren","interpretieren","priorisieren","analysieren","kritisieren","differenzieren","veranschaulichen","abstrahieren","konkretisieren","systematisieren","koordinieren","konstruieren","formulieren","hinterfragen","relativieren","prognostizieren","strukturieren","implizieren","moderieren"],
        adj:   ["ambivalent","konsequent","nachhaltig","subtil","detailliert","kontrovers","komplex","fragil","pragmatisch","konstruktiv","kritisch","innovativ","authentisch","intuitiv","reflektiert","nuanciert","souverÃ¤n","resilient","solidarisch","autonom"]
      }
    };

    const p1nameEl = document.getElementById("p1name");
    const p2nameEl = document.getElementById("p2name");
    const difficultyEl = document.getElementById("difficulty");
    const typeEl = document.getElementById("type");

    const startBtn = document.getElementById("startBtn");
    const restartBtn = document.getElementById("restartBtn");

    const revealBtn = document.getElementById("revealBtn");
    const rightBtn = document.getElementById("rightBtn");
    const wrongBtn = document.getElementById("wrongBtn");

    const turnBox = document.getElementById("turnBox");
    const turnName = document.getElementById("turnName");
    const turnBadge = document.getElementById("turnBadge");

    const wordHint = document.getElementById("wordHint");
    const wordEl = document.getElementById("word");

    const scoreText = document.getElementById("scoreText");
    const titleText = document.getElementById("titleText");
    const score2Box = document.getElementById("score2Box");
    const scoreText2 = document.getElementById("scoreText2");
    const titleText2 = document.getElementById("titleText2");

    const handoff = document.getElementById("handoff");
    const handoffTitle = document.getElementById("handoffTitle");
    const handoffText = document.getElementById("handoffText");
    const handoffOk = document.getElementById("handoffOk");

    let started=false;
    let revealed=false;
    let currentWord=null;

    let name1="Spieler 1";
    let name2="Spieler 2";
    let isTwoPlayers=false;

    let p1=0, p2=0;
    let currentPlayer=1;

    const deckState = {}; // key = diff|type

    function shuffle(arr){
      const a = arr.slice();
      for (let i=a.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }

    function getList(diff, type){
      const b = WORDS[diff];
      if (!b) return [];
      if (type==="all") return [...b.nomen, ...b.verb, ...b.adj];
      return b[type] || [];
    }

    function ensureDeck(diff, type){
      const key = `${diff}|${type}`;
      const list = getList(diff, type);
      if (!deckState[key] || deckState[key].idx >= deckState[key].deck.length){
        deckState[key] = { deck: shuffle(list), idx: 0 };
      }
    }

    function popWord(){
      wordEl.classList.remove("pop");
      void wordEl.offsetWidth;
      wordEl.classList.add("pop");
    }

    function showHandoff(){
      const who = (currentPlayer===1) ? name1 : name2;
      handoffTitle.textContent = "Handy weitergeben";
      handoffText.textContent = `Gib das Handy an ${who} und drÃ¼cke dann â€žOkay!â€œ.`;
      handoff.classList.add("show");
    }

    function hideHandoff(){
      handoff.classList.remove("show");
    }

    function updateTurnUI(){
      if (!started){
        turnBox.classList.add("hidden");
        return;
      }
      turnBox.classList.remove("hidden");

      const who = (currentPlayer===1) ? name1 : name2;
      turnName.textContent = who;
      turnBadge.textContent = isTwoPlayers ? `Spieler ${currentPlayer}` : "Solo";

      // farbiger Rahmen je Spieler
      if (isTwoPlayers && currentPlayer===2){
        turnBox.style.borderColor = "rgba(34,197,94,.28)";
        turnBadge.style.background = "rgba(34,197,94,.14)";
        turnBadge.style.borderColor = "rgba(34,197,94,.22)";
        turnBadge.style.color = "#166534";
      } else {
        turnBox.style.borderColor = "rgba(124,58,237,.28)";
        turnBadge.style.background = "rgba(124,58,237,.12)";
        turnBadge.style.borderColor = "rgba(124,58,237,.22)";
        turnBadge.style.color = "#5B21B6";
      }
    }

    function titleFor(points){
      const idx = Math.max(0, Math.min(TITLES.length-1, Math.floor(points/5)));
      return TITLES[idx];
    }

    function updateScoresUI(){
      scoreText.textContent = `Punkte (${name1}): ${p1}`;
      titleText.textContent = `Titel (${name1}): ${titleFor(p1)}`;

      if (isTwoPlayers){
        score2Box.classList.remove("hidden");
        scoreText2.textContent = `Punkte (${name2}): ${p2}`;
        titleText2.textContent = `Titel (${name2}): ${titleFor(p2)}`;
      } else {
        score2Box.classList.add("hidden");
      }
    }

    // Wichtig: Wort wird GENERIERT, aber zuerst versteckt
    function newHiddenWord(){
      const diff = difficultyEl.value;
      const type = typeEl.value;

      ensureDeck(diff, type);
      const key = `${diff}|${type}`;
      const ds = deckState[key];

      currentWord = (ds.deck.length ? ds.deck[ds.idx++] : "Keine WÃ¶rter.");
      revealed = false;

      wordHint.textContent = "Wort ist versteckt. (Jetzt: â€žWort anzeigenâ€œ)";
      wordEl.textContent = "â€¢â€¢â€¢â€¢â€¢";
      popWord();

      revealBtn.disabled = false;
      rightBtn.disabled = true;
      wrongBtn.disabled = true;
    }

    function revealWord(){
      if (!started || revealed) return;
      revealed = true;

      wordHint.textContent = "Wort:";
      wordEl.textContent = currentWord || "â€”";
      popWord();

      revealBtn.disabled = true;
      rightBtn.disabled = false;
      wrongBtn.disabled = false;
    }

    function applyResult(delta){
      if (!started) return;

      if (!isTwoPlayers){
        p1 += delta;
      } else {
        if (currentPlayer===1) p1 += delta;
        else p2 += delta;

        // Spielerwechsel â€“ aber neues Wort erst nach Ãœbergabe
        currentPlayer = (currentPlayer===1) ? 2 : 1;
      }

      updateScoresUI();
      updateTurnUI();

      // Neues Wort vorbereiten (versteckt)
      newHiddenWord();

      // Ãœbergabe-Screen zeigen (nur bei 2 Spielern)
      if (isTwoPlayers){
        showHandoff();
      }
    }

    function startGame(){
      name1 = (p1nameEl.value||"").trim() || "Spieler 1";
      const raw2 = (p2nameEl.value||"").trim();
      